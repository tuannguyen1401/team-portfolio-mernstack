<form action="/admin/projects/create" enctype="multipart/form-data" method="POST" class="max-w-4xl mx-auto bg-white p-8 rounded-2xl shadow-lg">
    <h2 class="text-2xl font-bold mb-6 text-gray-800">Thêm mới Project</h2>
    
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
      <!-- Tên -->
      <div class="col-span-2">
        <label for="name" class="block text-gray-700 font-medium mb-2">Tên</label>
        <input type="text" id="name" name="name" class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-blue-500" required>
      </div>
      
      <!-- Description với CKEditor -->
      <div class="col-span-2">
        <label for="description" class="block text-gray-700 font-medium mb-2">Description</label>
        <textarea id="description" name="description" class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-blue-500" rows="5"></textarea>
      </div>
      
      <!-- Image URL -->
      <div>
        <label for="image_url" class="block text-gray-700 font-medium mb-2">Image URL</label>
        <input type="file" id="image_url" name="image_url" accept="image/*" class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-blue-500" required>
        
        <!-- Image Preview -->
        <div id="imagePreview" class="mt-3 hidden">
          <div class="relative inline-block">
            <img id="previewImg" src="" alt="Preview" class="max-w-full h-32 object-cover rounded-lg border border-gray-300">
            <button type="button" id="removeImage" class="absolute -top-2 -right-2 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center hover:bg-red-600 transition-colors">
              ×
            </button>
          </div>
          <p class="text-sm text-gray-600 mt-2">File đã chọn: <span id="fileName"></span></p>
        </div>
      </div>
      
      <!-- Github URL -->
      <div>
        <label for="github_url" class="block text-gray-700 font-medium mb-2">Github URL</label>
        <input type="text" id="github_url" name="github_url" class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-blue-500" required>
      </div>
      
      <!-- Technologies -->
      <div>
        <label for="stack_name" class="block text-gray-700 font-medium mb-2">Stach Name</label>
        <input type="text" id="stack_name" name="stack_name" class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-blue-500" required>
      </div>

      <div>
        <label for="chplay_link" class="block text-gray-700 font-medium mb-2">CH Play link</label>
        <input type="text" id="chplay_link" name="chplay_link" class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-blue-500" required>
      </div>

      <div>
        <label for="appstore_link" class="block text-gray-700 font-medium mb-2">App Store Link</label>
        <input type="text" id="appstore_link" name="appstore_link" class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-blue-500" required>
      </div>
    </div>
    
    <!-- Buttons -->
    <div class="mt-8 flex items-center">
      <button type="submit" class="bg-blue-600 text-white px-6 py-3 rounded-lg shadow hover:bg-blue-700 transition">Thêm mới</button>
      <a href="/admin/projects" class="ml-4 text-gray-600 hover:underline">Quay lại</a>
    </div>
  </form>

  <!-- CKEditor 4 CDN với plugin upload -->
  <script src="https://cdn.ckeditor.com/4.22.1/standard/ckeditor.js"></script>
  
  <script>
    CKEDITOR.replace('description', {
      toolbar: [
        { name: 'document', items: ['Source', '-', 'Save', 'NewPage', 'Preview', 'Print', '-', 'Templates'] },
        { name: 'clipboard', items: ['Cut', 'Copy', 'Paste', 'PasteText', 'PasteFromWord', '-', 'Undo', 'Redo'] },
        { name: 'editing', items: ['Find', 'Replace', '-', 'SelectAll', '-', 'SpellChecker', 'Scayt'] },
        '/',
        { name: 'basicstyles', items: ['Bold', 'Italic', 'Underline', 'Strike', 'Subscript', 'Superscript', '-', 'RemoveFormat'] },
        { name: 'paragraph', items: ['NumberedList', 'BulletedList', '-', 'Outdent', 'Indent', '-', 'Blockquote', 'CreateDiv', '-', 'JustifyLeft', 'JustifyCenter', 'JustifyRight', 'JustifyBlock', '-', 'BidiLtr', 'BidiRtl'] },
        { name: 'links', items: ['Link', 'Unlink', 'Anchor'] },
        { name: 'insert', items: ['Image', 'Flash', 'Table', 'HorizontalRule', 'Smiley', 'SpecialChar', 'PageBreak', 'Iframe'] },
        '/',
        { name: 'styles', items: ['Styles', 'Format', 'Font', 'FontSize'] },
        { name: 'colors', items: ['TextColor', 'BGColor'] },
        { name: 'tools', items: ['Maximize', 'ShowBlocks', '-', 'About'] }
      ],
      height: 300,
      // Bật upload trực tiếp
      filebrowserUploadMethod: 'form',
      // URL để upload ảnh
      filebrowserUploadUrl: '/admin/upload-image',
      filebrowserImageUploadUrl: '/admin/upload-image',
      // Cấu hình upload
      uploadUrl: '/admin/upload-image',
      // Bật plugin upload
      extraPlugins: 'uploadimage,filetools,filebrowser',
      // Cấu hình upload
      upload: {
        types: ['jpeg', 'png', 'gif', 'webp'],
        multiple: true
      },
      // Tắt resize
      removePlugins: 'elementspath,resize'
    });

    // Image Preview Functionality
    document.getElementById('image_url').addEventListener('change', function(e) {
      const file = e.target.files[0];
      const preview = document.getElementById('imagePreview');
      const previewImg = document.getElementById('previewImg');
      const fileNameSpan = document.getElementById('fileName');
      
      if (file) {
        // Kiểm tra xem có phải file hình ảnh không
        if (file.type.startsWith('image/')) {
          const reader = new FileReader();
          
          reader.onload = function(e) {
            previewImg.src = e.target.result;
            preview.classList.remove('hidden');
            fileNameSpan.textContent = file.name;
          };
          
          reader.readAsDataURL(file);
        } else {
          alert('Vui lòng chọn file hình ảnh!');
          this.value = '';
          preview.classList.add('hidden');
          fileNameSpan.textContent = '';
        }
      } else {
        preview.classList.add('hidden');
        fileNameSpan.textContent = '';
      }
    });

    // Remove Image Functionality
    document.getElementById('removeImage').addEventListener('click', function() {
      const fileInput = document.getElementById('image_url');
      const preview = document.getElementById('imagePreview');
      const previewImg = document.getElementById('previewImg');
      const fileNameSpan = document.getElementById('fileName');
      
      // Clear file input
      fileInput.value = '';
      
      // Clear preview
      previewImg.src = '';
      preview.classList.add('hidden');
      fileNameSpan.textContent = '';
    });
  </script>
  